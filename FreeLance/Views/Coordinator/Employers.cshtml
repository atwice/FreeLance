@model FreeLance.Controllers.CoordinatorController.EmployersViewModel
@{
    ViewBag.Title = "Работодатели";
	ViewBag.MenuPick = "Employers";
}

@section css {
    <link rel="stylesheet" href="~/Content/jquery.raty.css">
    <style>
        td, th {
            text-align: center;
        }
    </style>
}
@section PageScripts{
    <!-- Include Raty JS file -->
    <script type="text/javascript" src="~/Scripts/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="~/Scripts/jquery.raty.js"></script>
}
<div class="row">
    <div class="col-md-10">
        <h2>@ViewBag.Title:</h2>
        @using (Html.BeginForm())
        {
            <p>
                @Html.TextBox("searchString")
                <input class="btn btn-info" type="submit" value="Поиск"/>
            </p>
        }
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>
                        <a href=@Url.Action("Freelancers", "Employer",
							new { sortOrder = ViewBag.sortName })>
                            <span class="glyphicon glyphicon-sort" aria-hidden="true"></span>
                            ФИО
                        </a>
                    </th>
                    <th>
                        <a href=@Url.Action("Freelancers", "Employer",
							new { sortOrder = ViewBag.sortEmail })>
                            <span class="glyphicon glyphicon-sort" aria-hidden="true"></span>
                            Email
                        </a>
                    </th>
                    <th>
                        <a href=@Url.Action("Freelancers", "Employer",
							new { sortOrder = ViewBag.sortDone })>
                            <span class="glyphicon glyphicon-sort" aria-hidden="true"></span>
                            Контрактов<br />закрыто
                        </a>
                    </th>
                    <th>
                        <a href=@Url.Action("Freelancers", "Employer",
							new { sortOrder = ViewBag.sortInProgress })>
                            <span class="glyphicon glyphicon-sort" aria-hidden="true"></span>
                            Контрактов<br />в работе
                        </a>
                    </th>
                    <th>
                        <a href=@Url.Action("Freelancers", "Employer",
							new { sortOrder = ViewBag.sortRate })>
                            <span class="glyphicon glyphicon-sort" aria-hidden="true"></span>
                            Рейтинг
                        </a>
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var freelancer in @Model)
                {
                    <tr>
                        <td>
                            <a href="/Freelancer/Details/@freelancer.Id">
                                @freelancer.Name
                            </a>
                        </td>
                        <td>
                            @freelancer.Email
                        </td>
                        <td>
                            @freelancer.ClosedContractsCount
                        </td>
                        <td>
                            @freelancer.OpenContractsCount
                        </td>
                        <td>
                            <span class="stars" data-score=@freelancer.Rate.ToString().Replace(",",".")></span>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<script>
	$(function () {
		$(".stars").each(function () {
			$(this).raty({
				path: "../../Content/images",
				readOnly: true,
				score: function () {
					return $(this).attr('data-score');
				}
			});
		});
	});
</script>

@*<div class="col-md-10">*@
@*	<h2>@ViewBag.Title</h2>*@
@*	<h3>Ожидают подтверждения</h3>*@
@*	<div class="list-group">*@
@*		@if (Model.EmployersNotApproved.Count == 0)*@
@*		{*@
@*			<h5>Все заявки подтверждены. Отличная работа!</h5>*@
@*		}*@
@*		else*@
@*		{*@
@*			foreach (var employer in Model.EmployersNotApproved)*@
@*			{*@
@*				<div class="list-group-item">*@
@*					@using (Html.BeginForm("ChangeEmployerApprovalStatus", "Coordinator",*@
@*						new { employerId = employer.Id,*@
@*								isApproved = employer.IsApprovedByCoordinator,*@
@*								redirect = "Employers"*@
@*							}))*@
@*					{*@
@*						<input type="submit" value="Допустить в систему" class="pull-right btn btn-success" />*@
@*					}*@
@**@
@*					<h4 class="list-group-item-heading">@employer.FIO</h4>*@
@*					<p class="list-group-item-text" style="color:lightgray"><i>@employer.Email</i></p>*@
@*					<p class="list-group-item-text" style="color:lightgray"><i>@employer.PhoneNumber</i></p>*@
@*				</div>*@
@*			}*@
@*		}*@
@*	</div>*@
@*	<h3>Подтвержденные работодатели</h3>*@
@*	<div class="list-group">*@
@*		@if (Model.EmployersApproved.Count == 0)*@
@*		{*@
@*			<h5>Все заявки подтверждены. Отличная работа!</h5>*@
@*		}*@
@*		else*@
@*		{*@
@*			foreach (var employer in Model.EmployersApproved)*@
@*			{*@
@*				<div class="list-group-item">*@
@*					@using (Html.BeginForm("ChangeEmployerApprovalStatus", "Coordinator",*@
@*						new*@
@*						{*@
@*							employerId = employer.Id,*@
@*							isApproved = employer.IsApprovedByCoordinator,*@
@*							redirect = "Employers"*@
@*						}))*@
@*					{*@
@*						<input type="submit" value="Отказать в доступе" class="pull-right btn btn-danger" />*@
@*					}*@
@**@
@*					<h4 class="list-group-item-heading">@employer.FIO</h4>*@
@*					<p class="list-group-item-text" style="color:lightgray"><i>@employer.Email</i></p>*@
@*					<p class="list-group-item-text" style="color:lightgray"><i>@employer.PhoneNumber</i></p>*@
@*				</div>*@
@*			}*@
@*		}*@
@*	</div>*@
@*</div>*@